-- Auto Boss
Tabs.Main:AddToggle("AutoBossToggle", {
    Title = "Auto Boss (Turn On With Auto Farm)",
    Default = false,
    Callback = function(value)
        autoBossEnabled = value
        shared.autoBoss = value
        if value then
            local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local placeId = game.PlaceId

shared.autoBoss = shared.autoBoss or false

-- Hàm đi theo boss
local function followBoss(bossModel)
    local hrp = bossModel:FindFirstChild("HumanoidRootPart")
    local humanoid = bossModel:FindFirstChild("Humanoid")
    if not hrp or not humanoid then return end

    while humanoid.Health > 0 and shared.autoBoss do
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = hrp.CFrame + Vector3.new(0, 5, 0)
        end
        task.wait(0.1)
    end

    print("[Boss] Đã bị tiêu diệt")

    if shared.autoFarm then
        shared.forceUnlock = false
        isTeleported = false
        shared.bienCaoCap = false
        task.wait(1)

        shared.autoFarmToggleRef:SetValue(false)
        task.wait(1)
        shared.autoFarmToggleRef:SetValue(true)
    else
        print("Không Gọi Hàm Teleport")
    end
end

-- Vòng lặp kiểm tra boss
task.spawn(function()
    while true do
        if not shared.autoBoss then
            task.wait(1)
            continue
        end

        local npcsFolder = workspace:FindFirstChild("Characters") and workspace.Characters:FindFirstChild("NPCs")
        if not npcsFolder then
            task.wait(1)
            continue
        end

        if placeId == 9224601490 then
            local marco = npcsFolder:FindFirstChild("Marco")
            if marco then
                print("[Marco] Đã xuất hiện")
                shared.forceUnlock = true
                task.wait(1)
                shared.bienCaoCap = true
                task.wait(1)
                followBoss(marco)
                repeat task.wait(0.5) until not npcsFolder:FindFirstChild("Marco") or not shared.autoBoss
            else
                print("[Marco] Chưa xuất hiện")
            end

        elseif placeId == 16190471004 then
            local cakeQueen = npcsFolder:FindFirstChild("Cake Queen")
            if cakeQueen then
                print("[Cake Queen] Đã xuất hiện")
                shared.forceUnlock = true
                task.wait(1)
                shared.bienCaoCap = true
                task.wait(1)
                followBoss(cakeQueen)
                repeat task.wait(0.5) until not npcsFolder:FindFirstChild("Cake Queen") or not shared.autoBoss
            else
                print("[Cake Queen] Chưa xuất hiện")
            end

            local katakuri = npcsFolder:FindFirstChild("Katakuri")
            if katakuri then
                print("[Katakuri] Đã xuất hiện")
                shared.forceUnlock = true
                task.wait(1)
                shared.bienCaoCap = true
                task.wait(1)
                followBoss(katakuri)
                repeat task.wait(0.5) until not npcsFolder:FindFirstChild("Katakuri") or not shared.autoBoss
            else
                print("[Katakuri] Chưa xuất hiện")
            end

        elseif placeId == 12413901502 then
            local kaido = npcsFolder:FindFirstChild("Kaido")
            if kaido then
                print("[Kaido] Đã xuất hiện")
                shared.forceUnlock = true
                task.wait(1)
                shared.bienCaoCap = true
                task.wait(1)
                followBoss(kaido)
                repeat task.wait(0.5) until not npcsFolder:FindFirstChild("Kaido") or not shared.autoBoss
            else
                print("[Kaido] Chưa xuất hiện")
            end

        else
            warn("Không hỗ trợ map này. PlaceId:", placeId)
            break
        end

        task.wait(1)
    end
end)
        end
    end
})
